<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.3.6), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html">

  <title>Benchmarker README</title>
  <meta name="generator" content="kwaser">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="docstyle.css" type="text/css">
</head>

<body>
  <blockquote>
    <div class="mainbody">
      <div align="left">
        <h1>Benchmarker README</h1>
      </div>

      <p>$Release: $<br>
      $License: Public Domain $<br>
      $Copyright: copyright(c) 2010-2011 kuwata-lab.com all rights reserved. $<br></p><a name="Overview" id="Overview"></a>

      <h2 class="section1">Overview</h2>

      <p>Benchmarker is a small utility for benchmarking.</p><a name="ex0.py" id="ex0.py"></a>

      <div class="program_caption">
        Quick Example (ex0.py)
      </div>
      <pre class="program">
from benchmarker import Benchmarker

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"
with Benchmarker(width=20, loop=1000*1000) as bm:
    for _ in bm.empty():     ## empty loop
        pass
    for _ in bm('join'):
        sos = ''.join((s1, s2, s3, s4, s5))
    for _ in bm('concat'):
        sos = s1 + s2 + s3 + s4 + s5
    for _ in bm('format'):
        sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)
</pre>

      <div class="terminal_caption">
        Output example
      </div>
      <pre class="terminal">
$ python ex0.py
## benchmarker:       release 0.0.0 (for python)
## python platform:   darwin [GCC 4.2.1 (Apple Inc. build 5664)]
## python version:    2.7.1
## python executable: /usr/local/python/2.7.1/bin/python

##                       user       sys     total      real
(Empty)                0.1600    0.0000    0.1600    0.1639
join                   0.6500    0.0000    0.6500    0.6483
concat                 0.5700    0.0000    0.5700    0.5711
format                 0.7600    0.0000    0.7600    0.7568

## Ranking               real
concat                 0.5711 (100.0%) *************************
join                   0.6483 ( 88.1%) **********************
format                 0.7568 ( 75.5%) *******************

## Ratio Matrix          real    [01]    [02]    [03]
[01] concat            0.5711  100.0%  113.5%  132.5%
[02] join              0.6483   88.1%  100.0%  116.7%
[03] format            0.7568   75.5%   85.7%  100.0%
</pre>

      <p>Notice that empty loop times (user, sys, total, and real) are subtracted from other benchmark times automatically. For example:</p>

      <div align="center">
        <table class="table2" border="1" cellspacing="0">
          <tr class="tr2">
            <th class="th2">benchmark label</th>

            <th class="th2">real (second)</th>
          </tr>

          <tr class="tr2">
            <td class="td2">join</td>

            <td class="td2">0.6483 (= 0.8122 - 0.1639)</td>
          </tr>

          <tr class="tr2">
            <td class="td2">concat</td>

            <td class="td2">0.5711 (= 0.7350 - 0.1639)</td>
          </tr>

          <tr class="tr2">
            <td class="td2">format</td>

            <td class="td2">0.7568 (= 0.9207 - 0.1639)</td>
          </tr>
        </table>
      </div>

      <p><span style="color:#FF0000">NOTICE:</span> This release doesn't have compatibility with previous version. See <a href="CHANGES.txt">CHANGES.txt</a> for details.</p><br>
      <a name="Download and Install"></a>

      <h2 class="section1">Download and Install</h2>

      <p><a href="http://pypi.python.org/pypi/Benchmarker/">http://pypi.python.org/pypi/Benchmarker/</a></p>

      <div class="terminal_caption">
        Installation
      </div>
      <pre class="terminal">
## if you have installed easy_install:
$ sudo easy_install Benchmarker
## or download Benchmarker-X.X.X.tar.gz and install it
$ wget http://pypi.python.org/packages/source/B/Benchmarker/Benchmarker-X.X.X.tar.gz
$ tar xzf Benchmarker-X.X.X.tar.gz
$ cd Benchmarker-X.X.X/
$ sudo python setup.py install
</pre><br>
      <a name="Step by Step Examples"></a>

      <h2 class="section1">Step by Step Examples</h2><a name="Basic Example"></a>

      <h3 class="section2">Basic Example</h3><a name="ex1.py" id="ex1.py"></a>

      <div class="program_caption">
        ex1.py
      </div>
      <pre class="program">
<strong>from benchmarker import Benchmarker</strong>

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"
loop = 1000 * 1000
<strong>with Benchmarker(width=20) as bm:</strong>
    <strong>with bm('join'):</strong>
        for i in xrange(loop):
            sos = ''.join((s1, s2, s3, s4, s5))
    <strong>with bm('concat'):</strong>
        for i in xrange(loop):
            sos = s1 + s2 + s3 + s4 + s5
    <strong>with bm('format'):</strong>
        for i in xrange(loop):
            sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)
</pre>

      <div class="terminal_caption">
        Output example
      </div>
      <pre class="terminal">
$ python ex1.py
## benchmarker:       release 0.0.0 (for python)
## python platform:   darwin [GCC 4.2.1 (Apple Inc. build 5664)]
## python version:    2.7.1
## python executable: /usr/local/python/2.7.1/bin/python

##                       user       sys     total      real
join                   0.7300    0.0000    0.7300    0.7358
concat                 0.6500    0.0000    0.6500    0.6482
format                 0.8400    0.0000    0.8400    0.8442

## Ranking               real
concat                 0.6482 (100.0%) *************************
join                   0.7358 ( 88.1%) **********************
format                 0.8442 ( 76.8%) *******************

## Ratio Matrix          real    [01]    [02]    [03]
[01] concat            0.6482  100.0%  113.5%  130.2%
[02] join              0.7358   88.1%  100.0%  114.7%
[03] format            0.8442   76.8%   87.2%  100.0%
</pre><br>
      <a name="Empty Loop"></a>

      <h3 class="section2">Empty Loop</h3><a name="ex2.py" id="ex2.py"></a>

      <div class="program_caption">
        ex2.py
      </div>
      <pre class="program">
from benchmarker import Benchmarker

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"
loop = 1000 * 1000
with Benchmarker(width=20) as bm:
    <strong>with bm.empty():</strong>
        <strong>for i in xrange(loop):</strong>
            <strong>pass</strong>
    with bm('join'):
        for i in xrange(loop):
            sos = ''.join((s1, s2, s3, s4, s5))
    with bm('concat'):
        for i in xrange(loop):
            sos = s1 + s2 + s3 + s4 + s5
    with bm('format'):
        for i in xrange(loop):
            sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)
</pre>

      <div class="terminal_caption">
        Output Example
      </div>
      <pre class="terminal">
$ python ex2.py
## benchmarker:       release 0.0.0 (for python)
## python platform:   darwin [GCC 4.2.1 (Apple Inc. build 5664)]
## python version:    2.7.1
## python executable: /usr/local/python/2.7.1/bin/python

##                       user       sys     total      real
(Empty)                0.0800    0.0000    0.0800    0.0824
join                   0.6600    0.0000    0.6600    0.6541
concat                 0.5600    0.0000    0.5600    0.5592
format                 0.7600    0.0000    0.7600    0.7603

## Ranking               real
concat                 0.5592 (100.0%) *************************
join                   0.6541 ( 85.5%) *********************
format                 0.7603 ( 73.6%) ******************

## Ratio Matrix          real    [01]    [02]    [03]
[01] concat            0.5592  100.0%  117.0%  135.9%
[02] join              0.6541   85.5%  100.0%  116.2%
[03] format            0.7603   73.6%   86.0%  100.0%
</pre>

      <p>Notice that benchmark results are subtracted by '(Empty)' loop results. For example:</p>

      <div align="center">
        <table class="table2" border="1" cellspacing="0">
          <tr class="tr2">
            <th class="th2">benchmark label</th>

            <th class="th2">real (second)</th>
          </tr>

          <tr class="tr2">
            <td class="td2">join</td>

            <td class="td2">0.6541 (= 0.7365 - 0.0824)</td>
          </tr>

          <tr class="tr2">
            <td class="td2">concat</td>

            <td class="td2">0.5592 (= 0.6416 - 0.0824)</td>
          </tr>

          <tr class="tr2">
            <td class="td2">format</td>

            <td class="td2">0.7603 (= 0.8427 - 0.0824)</td>
          </tr>
        </table>
      </div><br>
      <a name="Loop" id="Loop"></a>

      <h3 class="section2">Loop</h3><a name="ex3.py" id="ex3.py"></a>

      <div class="program_caption">
        ex3.py
      </div>
      <pre class="program">
from benchmarker import Benchmarker

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"
with Benchmarker(width=20, <strong>loop=1000*1000</strong>) as bm:
    <strong>for _ in bm.empty():</strong>
        pass
    <strong>for _ in bm('join'):</strong>
        sos = ''.join((s1, s2, s3, s4, s5))
    <strong>for _ in bm('concat'):</strong>
        sos = s1 + s2 + s3 + s4 + s5
    <strong>for _ in bm('format'):</strong>
        sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)
</pre>

      <div class="terminal_caption">
        Output Example
      </div>
      <pre class="terminal">
$ python ex3.py
## benchmarker:       release 0.0.0 (for python)
## python platform:   darwin [GCC 4.2.1 (Apple Inc. build 5664)]
## python version:    2.7.1
## python executable: /usr/local/python/2.7.1/bin/python

##                       user       sys     total      real
(Empty)                0.1600    0.0000    0.1600    0.1683
join                   0.6500    0.0000    0.6500    0.6457
concat                 0.5700    0.0000    0.5700    0.5660
format                 0.7500    0.0000    0.7500    0.7440

## Ranking               real
concat                 0.5660 (100.0%) *************************
join                   0.6457 ( 87.6%) **********************
format                 0.7440 ( 76.1%) *******************

## Ratio Matrix          real    [01]    [02]    [03]
[01] concat            0.5660  100.0%  114.1%  131.5%
[02] join              0.6457   87.6%  100.0%  115.2%
[03] format            0.7440   76.1%   86.8%  100.0%
</pre><br>
      <a name="Repeat" id="Repeat"></a>

      <h3 class="section2">Repeat</h3><a name="ex4.py" id="ex4.py"></a>

      <div class="program_caption">
        ex4.py
      </div>
      <pre class="program">
from benchmarker import Benchmarker

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"
with Benchmarker(width=25, loop=1000*1000) as bm:
    <strong>for _ in bm.repeat(3, extra=1):</strong>
        for _ in bm.empty():
            pass
        for _ in bm('join'):
            sos = ''.join((s1, s2, s3, s4, s5))
        for _ in bm('concat'):
            sos = s1 + s2 + s3 + s4 + s5
        for _ in bm('format'):
            sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)
</pre>

      <div class="terminal_caption">
        Output Example
      </div>
      <pre class="terminal">
$ python ex4.py
## benchmarker:       release 0.0.0 (for python)
## python platform:   darwin [GCC 4.2.1 (Apple Inc. build 5664)]
## python version:    2.7.1
## python executable: /usr/local/python/2.7.1/bin/python

## (#1)                       user       sys     total      real
(Empty)                     0.1600    0.0000    0.1600    0.1562
join                        0.6500    0.0000    0.6500    0.6591
concat                      0.5600    0.0000    0.5600    0.5626
format                      0.7500    0.0000    0.7500    0.7662

## (#2)                       user       sys     total      real
(Empty)                     0.1600    0.0000    0.1600    0.1561
join                        0.6500    0.0000    0.6500    0.6520
concat                      0.5500    0.0000    0.5500    0.5571
format                      0.7500    0.0000    0.7500    0.7524

## (#3)                       user       sys     total      real
(Empty)                     0.1500    0.0000    0.1500    0.1555
join                        0.6600    0.0000    0.6600    0.6563
concat                      0.5600    0.0000    0.5600    0.5593
format                      0.7500    0.0000    0.7500    0.7536

## (#4)                       user       sys     total      real
(Empty)                     0.1600    0.0000    0.1600    0.1585
join                        0.6500    0.0000    0.6500    0.6518
concat                      0.5500    0.0000    0.5500    0.5597
format                      0.7500    0.0000    0.7500    0.7539

## (#5)                       user       sys     total      real
(Empty)                     0.1600    0.0000    0.1600    0.1601
join                        0.6500    0.0000    0.6500    0.6482
concat                      0.5600    0.0000    0.5600    0.5703
format                      0.7400    0.0000    0.7400    0.7463

## Remove min &amp; max            min    repeat       max    repeat
join                        0.6482      (#5)    0.6591      (#1)
concat                      0.5571      (#2)    0.5703      (#5)
format                      0.7463      (#5)    0.7662      (#1)

## Average of 3 (=5-2*1)      user       sys     total      real
join                        0.6533    0.0000    0.6533    0.6534
concat                      0.5567    0.0000    0.5567    0.5605
format                      0.7500    0.0000    0.7500    0.7533

## Ranking                    real
concat                      0.5605 (100.0%) *************************
join                        0.6534 ( 85.8%) *********************
format                      0.7533 ( 74.4%) *******************

## Ratio Matrix               real    [01]    [02]    [03]
[01] concat                 0.5605  100.0%  116.6%  134.4%
[02] join                   0.6534   85.8%  100.0%  115.3%
[03] format                 0.7533   74.4%   86.7%  100.0%
</pre>

      <p>If you prefer to print only averaged data, pass <code>verbose=False</code> to <code>Benchmark()</code>.</p>
      <pre class="program">
with Benchmark(loop=1000*1000, <strong>verbose=False</strong>) as bm:
    ....
</pre>

      <p>Or just ignore standard error.</p>
      <pre class="terminal">
$ python ex4.py 2&gt;/dev/null
</pre><br>
      <a name="Function" id="Function"></a>

      <h3 class="section2">Function</h3>

      <p>You can write benchmark code as function.</p><a name="ex5.py" id="ex5.py"></a>

      <div class="program_caption">
        ex5.py
      </div>
      <pre class="program">
from benchmarker import Benchmarker

s1, s2, s3, s4, s5 = "Haruhi", "Mikuru", "Yuki", "Itsuki", "Kyon"

def f1(n):
    """join"""
    for _ in xrange(n):
        sos = ''.join((s1, s2, s3, s4, s5))
def f2(n):
    """concat"""
    for _ in xrange(n):
        sos = s1 + s2 + s3 + s4 + s5
def f3(n):
    """format"""
    for _ in xrange(loop):
        sos = '%s%s%s%s%s' % (s1, s2, s3, s4, s5)

loop = 1000 * 1000
with Benchmarker(width=20) as bm:
    for _ in bm.repeat(3, extra=1):
        <strong>bm.run(f1, loop)   # or bm('join').run(f1, loop)</strong>
        <strong>bm.run(f2, loop)   # or bm('concat').run(f2, loop)</strong>
        <strong>bm.run(f3, loop)   # or bm('format').run(f3, loop)</strong>
</pre>

      <p>Benchmarker uses document string of function as a label of benchmark. If function doesn't have a document string, Benchmarker uses function name as label instead of document string.</p>
      <pre class="program">
## This code...
bm.run(func, arg1, arg2)
## is same as:
bm(func.__doc__ or func.__name__).run(func, arg1, arg2)
</pre><br>
      <br>
      <a name="Tips" id="Tips"></a>

      <h2 class="section1">Tips</h2><a name="Output Format"></a>

      <h3 class="section2">Output Format</h3>

      <p>Benchmarker allows you to customize output format through <code>benchmarker.format</code> object.</p>
      <pre class="program">
from benchmarker import format
format.label_width = 30       # same as Benchmark(width=30)
format.time        = '%9.4f'
</pre><br>
      <a name="Benchmark Results"></a>

      <h3 class="section2">Benchmark Results</h3>

      <p>You can get benchmark results by <code>bm.results</code> or <code>bm.all_results</code>.</p>
      <pre class="program">
for result in bm.results:
    print(result.label)
    print(result.user)
    print(result.sys)
    print(result.total)
    print(result.real)
</pre><br>
      <a name="Python 2.4 support"></a>

      <h3 class="section2">Python 2.4 support</h3>

      <p>With-statement is not available in Python 2.4. But don't worry, Benchmarker provides a solution.</p>
      <pre class="program">
## Instead of with-statement,
with Benchmarker() as bm:
    for _ in bm.repeat(5):
        bm.run(func, arg1, arg2)

## for-statement is available!
<strong>for bm in Benchmarker(width=20):</strong>
    for _ in bm.repeat(5):
        bm.run(func, arg1, arg2)

## Or if you like:
bm = Benchmarker(width=20)
<strong>bm.__enter__()</strong>
for _ in bm.repeat(5):
    bm.run(func, arg1, arg2)
<strong>bm.__exit__()</strong>
</pre><br>
      <br>
    </div>
  </blockquote>
</body>
</html>
